
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Workflows &#8212; sasoptpy 1.0.4 documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/sasoptpy.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/js/url.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="../examples/examples.html" />
    <link rel="prev" title="Handling Data" href="input-data.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="../_static/js/version.js"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../examples/examples.html" title="Examples"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="input-data.html" title="Handling Data"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">sasoptpy 1.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="user-guide.html" accesskey="U">User Guide</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="workflows">
<span id="id1"></span><h1>Workflows<a class="headerlink" href="#workflows" title="Permalink to this headline">¶</a></h1>
<p>sasoptpy can work with both client-side data and server-side data.
Some limitations to the functionalities might apply in terms of which
workflow is used. In this section, the overall flow of the package
is explained.</p>
<div class="section" id="client-side-models">
<h2>Client-side models<a class="headerlink" href="#client-side-models" title="Permalink to this headline">¶</a></h2>
<p>If the data are client-side (Python), then a concrete model is generated
on the client and is uploaded by using one of the available CAS actions.</p>
<p>Using a client-side model brings several advantages, such as directly accessing
variables, expressions, and constraints. You can more easily perform computationally intensive
operations such as filtering data, sorting values, changing variable values,
and printing expressions.</p>
<p>There are two main disadvantages of working with client-side models.
First, if your model is relatively large, the generated
MPS DataFrame or OPTMODEL code might allocate a large amount of memory on your
machine.
Second, the information that needs to be passed from client to server
might be larger than it would be if you use a server-side model.</p>
<p>See the following representation of the client-side model workflow for CAS (Viya) servers:</p>
<img alt="../_images/clientside_cas.png" src="../_images/clientside_cas.png" />
<p>See the following representation of the client-side model workflow for SAS clients:</p>
<img alt="../_images/clientside_sas.png" src="../_images/clientside_sas.png" />
<p>Steps of modeling a simple knapsack problem are shown in the following subsections.</p>
<ol class="arabic">
<li><p>Reading data:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">sasoptpy</span> <span class="k">as</span> <span class="nn">so</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="kn">from</span> <span class="nn">swat</span> <span class="kn">import</span> <span class="n">CAS</span>

<span class="gp">In [4]: </span><span class="n">session</span> <span class="o">=</span> <span class="n">CAS</span><span class="p">(</span><span class="n">hostname</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">m</span> <span class="o">=</span> <span class="n">so</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;client_CAS&#39;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="go">NOTE: Initialized model client_CAS.</span>

<span class="gp">In [6]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
<span class="gp">   ...: </span>    <span class="p">[</span><span class="s1">&#39;clock&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">   ...: </span>    <span class="p">[</span><span class="s1">&#39;mug&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="gp">   ...: </span>    <span class="p">[</span><span class="s1">&#39;headphone&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">   ...: </span>    <span class="p">[</span><span class="s1">&#39;book&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="gp">   ...: </span>    <span class="p">[</span><span class="s1">&#39;pen&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>
<span class="gp">   ...: </span>    <span class="p">]</span>
<span class="gp">   ...: </span>

<span class="gp">In [7]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;item&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;limit&#39;</span><span class="p">])</span>

<span class="gp">In [8]: </span><span class="n">ITEMS</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>

<span class="gp">In [9]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

<span class="gp">In [10]: </span><span class="n">weight</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>

<span class="gp">In [11]: </span><span class="n">limit</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]</span>

<span class="gp">In [12]: </span><span class="n">total_weight</span> <span class="o">=</span> <span class="mi">55</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [13]: </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ITEMS</span><span class="p">),</span> <span class="n">ITEMS</span><span class="p">)</span>
<span class="go">&lt;class &#39;pandas.core.indexes.range.RangeIndex&#39;&gt; RangeIndex(start=0, stop=5, step=1)</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">total_weight</span><span class="p">),</span> <span class="n">total_weight</span><span class="p">)</span>
<span class="go">&lt;class &#39;int&#39;&gt; 55</span>
</pre></div>
</div>
<p>Here, you can obtain the column values one by one:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;item&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ITEMS</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;limit&#39;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Creating the optimization model:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Variables</span>
<span class="gp">In [15]: </span><span class="n">get</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_variables</span><span class="p">(</span><span class="n">ITEMS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="n">vartype</span><span class="o">=</span><span class="n">so</span><span class="o">.</span><span class="n">INT</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="go"># Constraints</span>
<span class="gp">In [16]: </span><span class="n">m</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">((</span><span class="n">get</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ITEMS</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;limit_con&#39;</span><span class="p">);</span>

<span class="gp">In [17]: </span><span class="n">m</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">so</span><span class="o">.</span><span class="n">expr_sum</span><span class="p">(</span><span class="n">weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">get</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ITEMS</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">total_weight</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;weight_con&#39;</span><span class="p">);</span>
<span class="gp">   ....: </span>

<span class="go"># Objective</span>
<span class="gp">In [18]: </span><span class="n">total_value</span> <span class="o">=</span> <span class="n">so</span><span class="o">.</span><span class="n">expr_sum</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">get</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ITEMS</span><span class="p">)</span>

<span class="gp">In [19]: </span><span class="n">m</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">total_value</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;total_value&#39;</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">so</span><span class="o">.</span><span class="n">MAX</span><span class="p">);</span>

<span class="go"># Solve</span>
<span class="gp">In [20]: </span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">NOTE: Added action set &#39;optimization&#39;.</span>
<span class="go">NOTE: Converting model client_CAS to OPTMODEL.</span>
<span class="go">   var get {{0,1,2,3,4}} integer &gt;= 0;</span>
<span class="go">   con limit_con_0 : get[0] &lt;= 3;</span>
<span class="go">   con limit_con_1 : get[1] &lt;= 5;</span>
<span class="go">   con limit_con_2 : get[2] &lt;= 2;</span>
<span class="go">   con limit_con_3 : get[3] &lt;= 10;</span>
<span class="go">   con limit_con_4 : get[4] &lt;= 15;</span>
<span class="go">   con weight_con : 4 * get[0] + 6 * get[1] + 7 * get[2] + 12 * get[3] + get[4] &lt;= 55;</span>
<span class="go">   max total_value = 8 * get[0] + 10 * get[1] + 15 * get[2] + 20 * get[3] + get[4];</span>
<span class="go">   solve;</span>
<span class="go">   create data solution from [i]= {1.._NVAR_} var=_VAR_.name value=_VAR_ lb=_VAR_.lb ub=_VAR_.ub rc=_VAR_.rc;</span>
<span class="go">   create data dual from [j] = {1.._NCON_} con=_CON_.name value=_CON_.body dual=_CON_.dual;</span>

<span class="go">NOTE: Submitting OPTMODEL code to CAS server.</span>
<span class="go">NOTE: Problem generation will use 8 threads.</span>
<span class="go">NOTE: The problem has 5 variables (0 free, 0 fixed).</span>
<span class="go">NOTE: The problem has 0 binary and 5 integer variables.</span>
<span class="go">NOTE: The problem has 6 linear constraints (6 LE, 0 EQ, 0 GE, 0 range).</span>
<span class="go">NOTE: The problem has 10 linear constraint coefficients.</span>
<span class="go">NOTE: The problem has 0 nonlinear constraints (0 LE, 0 EQ, 0 GE, 0 range).</span>
<span class="go">NOTE: The OPTMODEL presolver is disabled for linear problems.</span>
<span class="go">NOTE: The initial MILP heuristics are applied.</span>
<span class="go">NOTE: The MILP presolver value AUTOMATIC is applied.</span>
<span class="go">NOTE: The MILP presolver removed 0 variables and 5 constraints.</span>
<span class="go">NOTE: The MILP presolver removed 5 constraint coefficients.</span>
<span class="go">NOTE: The MILP presolver modified 0 constraint coefficients.</span>
<span class="go">NOTE: The presolved problem has 5 variables, 1 constraints, and 5 constraint coefficients.</span>
<span class="go">NOTE: The MILP solver is called.</span>
<span class="go">NOTE: The parallel Branch and Cut algorithm is used.</span>
<span class="go">NOTE: The Branch and Cut algorithm is using up to 8 threads.</span>
<span class="go">             Node   Active   Sols    BestInteger      BestBound      Gap    Time</span>
<span class="go">                0        1      4     99.0000000    199.0000000   50.25%       0</span>
<span class="go">                0        1      4     99.0000000    102.3333333    3.26%       0</span>
<span class="go">                0        1      4     99.0000000    102.3333333    3.26%       0</span>
<span class="go">NOTE: The MILP presolver is applied again.</span>
<span class="go">                0        1      4     99.0000000    102.3333333    3.26%       0</span>
<span class="go">NOTE: Optimal.</span>
<span class="go">NOTE: Objective = 99.</span>
<span class="go">NOTE: The output table &#39;SOLUTION&#39; in caslib &#39;CASUSER(casuser)&#39; has 5 rows and 6 columns.</span>
<span class="go">NOTE: The output table &#39;DUAL&#39; in caslib &#39;CASUSER(casuser)&#39; has 6 rows and 4 columns.</span>
<span class="go">NOTE: The CAS table &#39;solutionSummary&#39; in caslib &#39;CASUSER(casuser)&#39; has 18 rows and 4 columns.</span>
<span class="go">NOTE: The CAS table &#39;problemSummary&#39; in caslib &#39;CASUSER(casuser)&#39; has 20 rows and 4 columns.</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">Selected Rows from Table SOLUTION</span>

<span class="go">     i     var  value   lb             ub  rc</span>
<span class="go">0  1.0  get[0]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">1  2.0  get[1]    5.0 -0.0  1.797693e+308 NaN</span>
<span class="go">2  3.0  get[2]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">3  4.0  get[3]   -0.0 -0.0  1.797693e+308 NaN</span>
<span class="go">4  5.0  get[4]    3.0 -0.0  1.797693e+308 NaN</span>
</pre></div>
</div>
<p>You can display the generated OPTMODEL code at run time by using the <code class="code docutils literal notranslate"><span class="pre">verbose=True</span></code> option.
Here, you can see the coefficient values of the parameters inside the model.</p>
</li>
<li><p>Parsing the results:</p>
<p>After the solve, the primal and dual solution tables are obtained. You can print
the solution tables by using the <a class="reference internal" href="../api/generated/sasoptpy.Model.get_solution.html#sasoptpy.Model.get_solution" title="sasoptpy.Model.get_solution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Model.get_solution()</span></code></a> method.</p>
<p>It is also possible to print the optimal solution by using
the <code class="xref py py-func docutils literal notranslate"><span class="pre">get_solution_table()</span></code> function.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">get_solution</span><span class="p">())</span>
<span class="go">Selected Rows from Table SOLUTION</span>

<span class="go">     i     var  value   lb             ub  rc</span>
<span class="go">0  1.0  get[0]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">1  2.0  get[1]    5.0 -0.0  1.797693e+308 NaN</span>
<span class="go">2  3.0  get[2]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">3  4.0  get[3]   -0.0 -0.0  1.797693e+308 NaN</span>
<span class="go">4  5.0  get[4]    3.0 -0.0  1.797693e+308 NaN</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="nb">print</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">get_solution_table</span><span class="p">(</span><span class="n">get</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">ITEMS</span><span class="p">))</span>
<span class="go">   get</span>
<span class="go">0  2.0</span>
<span class="go">1  5.0</span>
<span class="go">2  2.0</span>
<span class="go">3 -0.0</span>
<span class="go">4  3.0</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total value:&#39;</span><span class="p">,</span> <span class="n">total_value</span><span class="o">.</span><span class="n">get_value</span><span class="p">())</span>
<span class="go">Total value: 99.0</span>
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="server-side-models">
<h2>Server-side models<a class="headerlink" href="#server-side-models" title="Permalink to this headline">¶</a></h2>
<p>If the data are server-side (CAS or SAS), then an abstract model
is generated on the client. This abstract model is later converted to
PROC OPTMODEL code, which reads the data on the server.</p>
<p>The main advantage of the server-side models is faster upload times compared
to client-side models. This is especially noticeable when using large numbers of
variable and constraint groups.</p>
<p>The only disadvantage of using server-side models is that variables often need
to be accessed directly from the resulting SASDataFrame objects. Because
components of the models are abstract, accessing objects directly is often
not possible.</p>
<p>See the following representation of the server-side model workflow for CAS (Viya) servers:</p>
<img alt="../_images/serverside_cas.png" src="../_images/serverside_cas.png" />
<p>See the following representation of the server-side model workflow for SAS clients:</p>
<img alt="../_images/serverside_sas.png" src="../_images/serverside_sas.png" />
<p>In the following steps, the same example is solved by using server-side
data.</p>
<ol class="arabic">
<li><p>Creating the optimization model:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="kn">from</span> <span class="nn">sasoptpy.actions</span> <span class="kn">import</span> <span class="n">read_data</span>

<span class="gp">In [25]: </span><span class="n">m</span> <span class="o">=</span> <span class="n">so</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;client_CAS&#39;</span><span class="p">,</span> <span class="n">session</span><span class="o">=</span><span class="n">session</span><span class="p">)</span>
<span class="go">NOTE: Initialized model client_CAS.</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">cas_table</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">upload_frame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">casout</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="go">NOTE: Cloud Analytic Services made the uploaded file available as table DATA in caslib CASUSER(casuser).</span>
<span class="go">NOTE: The table DATA has been created in caslib CASUSER(casuser) from binary data uploaded to Cloud Analytic Services.</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [27]: </span><span class="n">ITEMS</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_set</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ITEMS&#39;</span><span class="p">,</span> <span class="n">settype</span><span class="o">=</span><span class="n">so</span><span class="o">.</span><span class="n">STR</span><span class="p">)</span>

<span class="gp">In [28]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">ITEMS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

<span class="gp">In [29]: </span><span class="n">weight</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">ITEMS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>

<span class="gp">In [30]: </span><span class="n">limit</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="n">ITEMS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;limit&#39;</span><span class="p">)</span>

<span class="gp">In [31]: </span><span class="n">m</span><span class="o">.</span><span class="n">include</span><span class="p">(</span><span class="n">read_data</span><span class="p">(</span>
<span class="gp">   ....: </span>   <span class="n">table</span><span class="o">=</span><span class="n">cas_table</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="n">ITEMS</span><span class="p">,</span> <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="s1">&#39;item&#39;</span><span class="p">},</span>
<span class="gp">   ....: </span>   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">value</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">limit</span><span class="p">]))</span>
<span class="gp">   ....: </span>

<span class="go"># Variables</span>
<span class="gp">In [32]: </span><span class="n">get</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">add_variables</span><span class="p">(</span><span class="n">ITEMS</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;get&#39;</span><span class="p">,</span> <span class="n">vartype</span><span class="o">=</span><span class="n">so</span><span class="o">.</span><span class="n">INT</span><span class="p">,</span> <span class="n">lb</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="go"># Constraints</span>
<span class="gp">In [33]: </span><span class="n">m</span><span class="o">.</span><span class="n">add_constraints</span><span class="p">((</span><span class="n">get</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">limit</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ITEMS</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;limit_con&#39;</span><span class="p">);</span>

<span class="gp">In [34]: </span><span class="n">m</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">so</span><span class="o">.</span><span class="n">expr_sum</span><span class="p">(</span><span class="n">weight</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">get</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ITEMS</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">total_weight</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;weight_con&#39;</span><span class="p">);</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Objective</span>
<span class="gp">In [35]: </span><span class="n">total_value</span> <span class="o">=</span> <span class="n">so</span><span class="o">.</span><span class="n">expr_sum</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">get</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ITEMS</span><span class="p">)</span>

<span class="gp">In [36]: </span><span class="n">m</span><span class="o">.</span><span class="n">set_objective</span><span class="p">(</span><span class="n">total_value</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;total_value&#39;</span><span class="p">,</span> <span class="n">sense</span><span class="o">=</span><span class="n">so</span><span class="o">.</span><span class="n">MAX</span><span class="p">);</span>

<span class="go"># Solve</span>
<span class="gp">In [37]: </span><span class="n">m</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">NOTE: Added action set &#39;optimization&#39;.</span>
<span class="go">NOTE: Converting model client_CAS to OPTMODEL.</span>
<span class="go">   set &lt;str&gt; ITEMS;</span>
<span class="go">   num value {{ITEMS}};</span>
<span class="go">   num weight {{ITEMS}};</span>
<span class="go">   num limit {{ITEMS}};</span>
<span class="go">   read data DATA into ITEMS=[item] value weight limit;</span>
<span class="go">   var get {{ITEMS}} integer &gt;= 0;</span>
<span class="go">   con limit_con {o37 in ITEMS} : get[o37] - limit[o37] &lt;= 0;</span>
<span class="go">   con weight_con : sum {i in ITEMS} (weight[i] * get[i]) &lt;= 55;</span>
<span class="go">   max total_value = sum {i in ITEMS} (value[i] * get[i]);</span>
<span class="go">   solve;</span>
<span class="go">   create data solution from [i]= {1.._NVAR_} var=_VAR_.name value=_VAR_ lb=_VAR_.lb ub=_VAR_.ub rc=_VAR_.rc;</span>
<span class="go">   create data dual from [j] = {1.._NCON_} con=_CON_.name value=_CON_.body dual=_CON_.dual;</span>

<span class="go">NOTE: Submitting OPTMODEL code to CAS server.</span>
<span class="go">NOTE: There were 5 rows read from table &#39;DATA&#39; in caslib &#39;CASUSER(casuser)&#39;.</span>
<span class="go">NOTE: Problem generation will use 8 threads.</span>
<span class="go">NOTE: The problem has 5 variables (0 free, 0 fixed).</span>
<span class="go">NOTE: The problem has 0 binary and 5 integer variables.</span>
<span class="go">NOTE: The problem has 6 linear constraints (6 LE, 0 EQ, 0 GE, 0 range).</span>
<span class="go">NOTE: The problem has 10 linear constraint coefficients.</span>
<span class="go">NOTE: The problem has 0 nonlinear constraints (0 LE, 0 EQ, 0 GE, 0 range).</span>
<span class="go">NOTE: The OPTMODEL presolver is disabled for linear problems.</span>
<span class="go">NOTE: The initial MILP heuristics are applied.</span>
<span class="go">NOTE: The MILP presolver value AUTOMATIC is applied.</span>
<span class="go">NOTE: The MILP presolver removed 0 variables and 5 constraints.</span>
<span class="go">NOTE: The MILP presolver removed 5 constraint coefficients.</span>
<span class="go">NOTE: The MILP presolver modified 0 constraint coefficients.</span>
<span class="go">NOTE: The presolved problem has 5 variables, 1 constraints, and 5 constraint coefficients.</span>
<span class="go">NOTE: The MILP solver is called.</span>
<span class="go">NOTE: The parallel Branch and Cut algorithm is used.</span>
<span class="go">NOTE: The Branch and Cut algorithm is using up to 8 threads.</span>
<span class="go">             Node   Active   Sols    BestInteger      BestBound      Gap    Time</span>
<span class="go">                0        1      4     99.0000000    199.0000000   50.25%       0</span>
<span class="go">                0        1      4     99.0000000    102.3333333    3.26%       0</span>
<span class="go">                0        0      4     99.0000000     99.0000000    0.00%       0</span>
<span class="go">NOTE: Optimal.</span>
<span class="go">NOTE: Objective = 99.</span>
<span class="go">NOTE: The output table &#39;SOLUTION&#39; in caslib &#39;CASUSER(casuser)&#39; has 5 rows and 6 columns.</span>
<span class="go">NOTE: The output table &#39;DUAL&#39; in caslib &#39;CASUSER(casuser)&#39; has 6 rows and 4 columns.</span>
<span class="go">NOTE: The CAS table &#39;solutionSummary&#39; in caslib &#39;CASUSER(casuser)&#39; has 18 rows and 4 columns.</span>
<span class="go">NOTE: The CAS table &#39;problemSummary&#39; in caslib &#39;CASUSER(casuser)&#39; has 20 rows and 4 columns.</span>
<span class="gh">Out[37]: </span><span class="go"></span>
<span class="go">Selected Rows from Table SOLUTION</span>

<span class="go">     i             var  value   lb             ub  rc</span>
<span class="go">0  1.0       get[book]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">1  2.0      get[clock]    3.0 -0.0  1.797693e+308 NaN</span>
<span class="go">2  3.0  get[headphone]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">3  4.0        get[mug]   -0.0 -0.0  1.797693e+308 NaN</span>
<span class="go">4  5.0        get[pen]    5.0 -0.0  1.797693e+308 NaN</span>
</pre></div>
</div>
</li>
<li><p>Parsing the results:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Print results</span>
<span class="gp">In [38]: </span><span class="nb">print</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">get_solution</span><span class="p">())</span>
<span class="go">Selected Rows from Table SOLUTION</span>

<span class="go">     i             var  value   lb             ub  rc</span>
<span class="go">0  1.0       get[book]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">1  2.0      get[clock]    3.0 -0.0  1.797693e+308 NaN</span>
<span class="go">2  3.0  get[headphone]    2.0 -0.0  1.797693e+308 NaN</span>
<span class="go">3  4.0        get[mug]   -0.0 -0.0  1.797693e+308 NaN</span>
<span class="go">4  5.0        get[pen]    5.0 -0.0  1.797693e+308 NaN</span>
</pre></div>
</div>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total value:&#39;</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">get_objective_value</span><span class="p">())</span>
<span class="go">Total value: 99.0</span>
</pre></div>
</div>
<p>Because there is no direct access to expressions and variables, the optimal
solution is printed by using the server response.</p>
</li>
</ol>
</div>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>In SAS Viya, nonlinear models can be solved only by using the runOptmodel action, which
requires SAS Viya 3.4 or later.</p></li>
<li><p>User-defined decomposition blocks are available only in MPS mode, and therefore work only with client-side data.</p></li>
<li><p>Mixed usage (client-side and server-side data) might not work in some cases.
A quick fix would be transferring the data in either direction.</p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<span id="version_switch">
<select onchange="chooseVersion(this);" style="background-color: transparent; color: black; min-width: 33%; margin: 0px 0px 10px 10px;">
<option value="latest">Latest</option>
<option value="1.0.3">1.0.3</option>
<option value="1.0.0">1.0.0</option>
<option value="0.2.1">0.2.1</option>
<option value="0.2.0">0.2.0</option>
<option value="0.1.2">0.1.2</option>
<option value="0.1.1">0.1.1</option>
<option value="0.1.0">0.1.0</option>
</select>
</span>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="user-guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Introduction to Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics.html">Quick Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="sessions.html">Sessions</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="components.html">Model Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="workspaces.html">Workspaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="input-data.html">Handling Data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#client-side-models">Client-side models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#server-side-models">Server-side models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../version-history.html">Version History</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../examples/examples.html" title="Examples"
             >next</a> |</li>
        <li class="right" >
          <a href="input-data.html" title="Handling Data"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">sasoptpy 1.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="user-guide.html" >User Guide</a> &#187;</li> 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2021, SAS Institute.
      Last updated on Mar 31, 2021 (Timestamp: 1.0-20210331210924).
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155356999-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155356999-1');
</script>


  </body>
</html>